<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>회원 기본 정보 수정</title>
<link rel="stylesheet" href="/">

<script>
window.onload = () => {
	
	btnRegister.addEventListener('click',async ()=> {
		
		//유효성 검사
		if(telno.value == '') {
			alert("전화번호를 입력하세요");
			telno.focus();
			return false;
		}
		const beforeTelno = telno.value;
		const afterTelno = beforeTelno.replace(/\-/ig,"").replace(/\ /ig,"").trim();
		telno.value = afterTelno;
		
		if(email.value == '') {
			alert("이메일 주소를 입력하세요");
			email.focus();
			return false;
		}
		const formData = new FormData(RegistryForm);
		
		await fetch('/member/memberInfoModify', {
			method: 'POST',
			body: formData
		}).then((response)=> response.json())
			.then((data)=> {
				if(data.message === 'GOOD'){
					alert(decodeURIComponent(data.username) + '님께서 회원 정보를 변경하셨습니다.');
					document.location.href='/board/list?page=1';
				} else {
					alert("서버 장애로 회원 정보 변경에 실패했습니다.");
				}
		}).catch((error)=> {
			console.lor("error = " + error);
		});
		
		//document.RegistryForm.action = '/member/signup';
		//document.RegistryForm.submit();
	});	
}

</script>

</head>
<body>
<div class="main">
	<h1>회원 기본 정보 변경</h1><br>
	
	<div class="WriteForm">
		<form id="RegistryForm" name="RegistryForm" method="POST" enctype="multipart/form-data">
		<br><br>
			<input type="text" id="telno" class="input_field" name="telno" placeholder="전화번호를 입력하세요">
			<input type="text" id="email" class="input_field" name="email" placeholder=" 이메일주소를 입력하세요">			
			<input type="button" id="btnRegister" class="btn_write" value="수정">		
			<input type="button" class="btn_cancel" value="취소" onclick="history.back()">	
		</form>
		<br><br>
	
	</div>

</div>
<br><br>
</body>
</html>